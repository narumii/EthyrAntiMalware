package xyz.ethyr;

import java.io.File;
import java.util.Arrays;
import xyz.ethyr.antimalware.AntiMalware;

public class Bootstrap {

  public static void main(String... args) {
    if (args.length == 0) {
      System.out.println(
          "You can scan given directory using (otherwise it will scan jars in current directory, also you can launch is like plugin): java -jar EthyrAntiMalware.jar path");
    }

    /*
    Wait, stop there pls this code is something that even i can't explain xd
     */
    String path;
    if (args.length > 0) {
      path = args[0];
    } else {
      path = Bootstrap.class.getProtectionDomain().getCodeSource().getLocation().getPath();
      if (path.endsWith(".jar")) {
        String[] split = path.split(File.separator);
        path = String.join(File.separator, Arrays.copyOfRange(split, 0, split.length - 1));
      }
    }

    if (path == null) {
      throw new NullPointerException("path");
    }

    AntiMalware.getInstance().start(path);
  }
}
