package xyz.ethyr.antimalware.check.impl;

import xyz.ethyr.antimalware.AntiMalware.Plugin;
import xyz.ethyr.antimalware.check.Check;
import xyz.ethyr.antimalware.helper.BlockHelper;

public class OriginalClassHideCheck implements Check {

  /*
  Some antihacking for example

  Original:

  public void xd() {
    throw new XDException();
  }

  Obfuscated:

  public void xd() {
    throw new X();
  }

  public class X extends XDException {
    ...
  }
   */

  @Override
  public void check(Plugin plugin) {
    plugin.getClasses().forEach(classNode -> {
      if (BlockHelper.isBlacklistedClass(classNode.superName)) {
        plugin
            .addLog(classNode.name + " -> Class extends blacklisted class: " + classNode.superName);
      }
    });
  }
}
