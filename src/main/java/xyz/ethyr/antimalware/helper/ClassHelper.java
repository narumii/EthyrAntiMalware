package xyz.ethyr.antimalware.helper;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;

public class ClassHelper {

  public static boolean isClass(String fileName, byte[] bytes) {
    return bytes.length >= 4 && String
        .format("%02X%02X%02X%02X", bytes[0], bytes[1], bytes[2], bytes[3]).equals("CAFEBABE") && (
        fileName.endsWith(".class") || fileName.endsWith(".class/"));
  }

  /*
  readAllBytes in ClassHelper yes fuck off
   */
  public static byte[] readAllBytes(InputStream inputStream) throws IOException {
    try (ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream()) {
      byte[] buf = new byte[1024];
      while (inputStream.available() > 0) {
        int read = inputStream.read(buf);
        byteArrayOutputStream.write(buf, 0, read);
      }

      return byteArrayOutputStream.toByteArray();
    }
  }
}
