package xyz.ethyr.antimalware.helper;

import org.objectweb.asm.Opcodes;
import org.objectweb.asm.tree.AbstractInsnNode;
import org.objectweb.asm.tree.LdcInsnNode;

public class ASMHelper implements Opcodes {

  public static boolean isStringus(AbstractInsnNode node) {
    return node instanceof LdcInsnNode && ((LdcInsnNode) node).cst instanceof String;
  }

  public static String getStringus(AbstractInsnNode node) {
    return (String) ((LdcInsnNode) node).cst;
  }

  /*
  isUnicdoe: ASMHelper yes
   */
  public static boolean isUnicode(String string) {
    for (char c : string.toCharArray()) {
      if (c > 127) {
        return true;
      }
    }

    return false;
  }

  /*
  ASMHelper??????
   */
  public static double percentage(int value, int total) {
    return (double) value * 100 / total;
  }
}