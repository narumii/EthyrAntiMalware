package xyz.ethyr.antimalware.helper;

import java.util.Arrays;
import java.util.List;

public class BlockHelper {

  /*
  Should i recode this?
   */

  /*
  Wanna some reflections????????
   */
  private static final List<String> limitedMethods = Arrays.asList(
      "java/lang/Class.getMethod",
      "java/lang/Class.getDeclaredMethod",
      "java/lang/Class.getMethods",
      "java/lang/Class.getField",
      "java/lang/Class.getDeclaredField",
      "java/lang/Class.getFields",
      "java/lang/invoke/MethodHandles.publicLookup",
      "java/lang/invoke/MethodHandles.lookup",
      "java/lang/invoke/MethodHandles.privateLookupIn"
  );


  /*
  Big methods
   */
  private static final List<String> blacklistedMethods = Arrays.asList(
      "java/lang/System.setSecurityManager",
      "java/lang/Runtime.halt",
      "java/lang/System.exit",
      "java/lang/Runtime.exec",
      "java/lang/System.getenv",
      "org/bukkit/Server.dispatchCommand",
      "org/bukkit/Server.shutdown",
      "java/net/Socket.<init>",
      "java/net/ServerSocket.<init>",
      "java/nio/channels/SocketChannel.open",
      "java/nio/channels/ServerSocketChannel.open",
      "java/net/DatagramSocket.<init>",
      "java/lang/ProcessBuilder.<init>",
      "java/lang/Thread.setContextClassLoader"
  );

  /*
  Big classes
   */
  private static final List<String> blacklistedClasses = Arrays.asList(
      "java/lang/System",
      "java/lang/Runtime",
      "java/net/Socket",
      "java/net/ServerSocket",
      "org/objectweb/asm",
      "net/bytebuddy",
      "java/lang/ProcessBuilder",
      "javassist",
      "org.javassist" //I don't know what package have javassist xd
  );

  public static boolean isBlacklistedMethod(String classMethodName) {
    return blacklistedMethods.contains(classMethodName);
  }

  public static boolean isLimitedMethod(String classMethodName) {
    return limitedMethods.contains(classMethodName);
  }

  public static boolean isBlacklistedClass(String className) {
    return blacklistedClasses.contains(className);
  }
}
